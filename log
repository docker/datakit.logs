=== Docker build Dockerfile.client
[2019-03-11 12:13.04] Starting...
Cloning into '/tmp/with_clone29ece33a'...
done.
HEAD is now at 0c95850 release 0.12.3
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 5.871 MB
Step 1/16 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:22c602c753b42f7db92ad08187b89c80ae9a68991f65b2d6743fb862d20b0875
Status: Image is up to date for ocaml/opam2:alpine
 ---> b29794a38c38
Step 2/16 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 09ba0013948b
Step 3/16 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 478e83d1f5e6
Step 4/16 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset b01a2e4e1ac2fb545d593ad40bc95b4a78dec9e2 --hard &&     opam update -u
 ---> Using cache
 ---> 9e5b4761e5bf
Step 5/16 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> 8df47c40e2de
Step 6/16 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> 0c36844080a6
Step 7/16 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> 751b3ebbb001
Step 8/16 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> 09d808fa3c7a
Step 9/16 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> b88177272f82
Step 10/16 : RUN OPAMSOLVERTIMEOUT=120 opam install datakit-client-git datakit-client-9p --deps -t
 ---> Using cache
 ---> 36a6a97c2b7d
Step 11/16 : COPY . /home/opam/src/datakit
 ---> 12c925a66c90
Error removing intermediate container 9632b7e1c802: driver "aufs" failed to remove root filesystem for 9632b7e1c802f53c7f5baf45e32cb947d24702bafeaa1d452d43d38fe61a6f7c: could not remove diff path for id fcbdf53e76a046314f3961484d1831a0c44b4ba9c9470122ddd47b638e56fca9: error preparing atomic delete: rename /var/lib/docker/aufs/diff/fcbdf53e76a046314f3961484d1831a0c44b4ba9c9470122ddd47b638e56fca9 /var/lib/docker/aufs/diff/fcbdf53e76a046314f3961484d1831a0c44b4ba9c9470122ddd47b638e56fca9-removing: device or resource busy
Step 12/16 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 38e8ce909140
 ---> bea4a43c83da
Removing intermediate container 9632b7e1c802
Error removing intermediate container 38e8ce909140: driver "aufs" failed to remove root filesystem for 38e8ce909140b73749d4c36eac83ab5ced83c5b21f3b275bb74918c8037aec29: could not remove diff path for id e88f78f5d0c4e136fc13620c24abe855fc276c47c78267d6d50e948d8df7894e: error preparing atomic delete: rename /var/lib/docker/aufs/diff/e88f78f5d0c4e136fc13620c24abe855fc276c47c78267d6d50e948d8df7894e /var/lib/docker/aufs/diff/e88f78f5d0c4e136fc13620c24abe855fc276c47c78267d6d50e948d8df7894e-removing: device or resource busy
Step 13/16 : RUN opam update --dev && opam upgrade
 ---> Running in c338d3a72220

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.2] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client 0.12.2* [upstream changes]

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-client.0.12.2
-> installed datakit-client.0.12.2
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 0d69ded6ee25
Removing intermediate container c338d3a72220
Removing intermediate container 38e8ce909140
Step 14/16 : RUN opam install datakit-client-9p datakit-client-git -tyv
 ---> Running in e6f14da978d8

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit-client-9p.0.12.2: rsync]
Processing  2/2: [datakit-client-9p.0.12.2: rsync] [datakit-client-git.0.12.2: rsync]
[datakit-client-9p.0.12.2] no changes from file:///home/opam/src/datakit
Processing  2/2: [datakit-client-git.0.12.2: rsync]
[datakit-client-git.0.12.2] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-client-git 0.12.2*
  - install datakit-client-9p  0.12.2*
===== 2 to install =====

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/4: [datakit-client-9p: dune build]
Processing  2/4: [datakit-client-9p: dune build] [datakit-client-git: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-client-9p" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-client-9p.0.12.2)
-> compiled  datakit-client-9p.0.12.2
Processing  2/4: [datakit-client-git: dune build]
-> installed datakit-client-9p.0.12.2
Processing  3/4: [datakit-client-git: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-client-git" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-client-git.0.12.2)
Processing  3/4: [datakit-client-git: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit-git" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-client-git.0.12.2)
-         test alias tests/datakit-git/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- +7098us irw-polling [INFO] Polling mode
- Testing datakit-git.
- This run has ID `C5848D14-90BD-4F86-A969-828596ED42FB`.
- [33m ...[m                [36mclient[m          0   Transaction.[32m[OK][m                [36mclient[m          0   Transaction.
- [33m ...[m                [36mclient[m          1   Watch.[32m[OK][m                [36mclient[m          1   Watch.
- [33m ...[m                [36mclient[m          2   Make dirs.[32m[OK][m                [36mclient[m          2   Make dirs.
- [33m ...[m                [36mclient[m          3   Truncate.[32m[OK][m                [36mclient[m          3   Truncate.
- [33m ...[m                [36mclient[m          4   Parents.[32m[OK][m                [36mclient[m          4   Parents.
- [33m ...[m                [36mclient[m          5   Merge.[32m[OK][m                [36mclient[m          5   Merge.
- [33m ...[m                [36mclient[m          6   Diff.[32m[OK][m                [36mclient[m          6   Diff.
- [33m ...[m                [36mclient[m          7   Merge_metadata.[32m[OK][m                [36mclient[m          7   Merge_metadata.
- [33m ...[m                [36mclient[m          8   Merge empty.[32m[OK][m                [36mclient[m          8   Merge empty.
- [33m ...[m                [36mclient[m          9   Conflicts.[32m[OK][m                [36mclient[m          9   Conflicts.
- [33m ...[m                [36mclient[m         10   Large write.[32m[OK][m                [36mclient[m         10   Large write.
- [33m ...[m                [36mclient[m         11   Remove.[32m[OK][m                [36mclient[m         11   Remove.
- [33m ...[m                [36mclient[m         12   Remotes.[33m[SKIP][m              [36mclient[m         12   Remotes.
- [33m ...[m                [36mclient[m         13   Create_or_replace.[33m[SKIP][m              [36mclient[m         13   Create_or_replace.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit-client-git.0.12.2/_build/default/tests/datakit-git/_build/_tests/C5848D14-90BD-4F86-A969-828596ED42FB`.
- [32mTest Successful[m in 0.452s. 12 tests run.
-> compiled  datakit-client-git.0.12.2
-> installed datakit-client-git.0.12.2
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 1b01b0d9e5fe
Removing intermediate container e6f14da978d8
Step 15/16 : RUN sudo mkdir /data && sudo chown opam.nogroup /data && chmod 700 /data &&     sudo cp $(opam config exec -- which datakit-mount) /usr/bin/datakit-mount
 ---> Running in e7821fd85494
 ---> a1fa21fb86e6
Removing intermediate container e7821fd85494
Step 16/16 : CMD bash -c "/usr/bin/datakit-mount -h $(getent hosts datakit | awk '{print $1}')";     bash
 ---> Running in 6892fe631f35
 ---> 1337dc637219
Removing intermediate container 6892fe631f35
Successfully built 1337dc637219
[2019-03-11 12:13.29] Success
