=== Docker build Dockerfile
[2019-07-12 14:57.11] Starting...
Cloning into '/tmp/with_clone1c47bae7'...
done.
HEAD is now at e047e55 apply ocamlformat 0.10 with the conventional profile
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.684 MBSending build context to Docker daemon 6.684 MB
Step 1/23 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:80f944d8924204d38d8c588a6906010ddfd6364c226a26077b99a95028270790
Status: Image is up to date for ocaml/opam2:alpine
 ---> bfd59b6fbeb7
Step 2/23 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 3cfa4c307c86
Step 3/23 : RUN opam switch 4.07
 ---> Using cache
 ---> 61f8129282a1
Step 4/23 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 45575532b93e
Step 5/23 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset 340acb7d88264bf29485b1d292388e1d91dc2214 --hard &&     opam update -u
 ---> Using cache
 ---> bf4c8aa48c34
Step 6/23 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> 18bba6bd5a39
Step 7/23 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> fadc6c1094dc
Step 8/23 : RUN opam exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> db33a3222fb3
Step 9/23 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> d17f556f6780
Step 10/23 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> 437a0bf12aeb
Step 11/23 : RUN opam install datakit --deps -t
 ---> Using cache
 ---> f26d68a5b647
Step 12/23 : COPY . /home/opam/src/datakit
 ---> 090f08de6b77
Removing intermediate container 17b2ac180b19
Step 13/23 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 0572a618b17b
 ---> 6558d6d0e4e2
Removing intermediate container 0572a618b17b
Step 14/23 : RUN opam update --dev && opam upgrade
 ---> Running in cf780142680f

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.4] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client    0.12.3* [upstream changes]
  - recompile datakit-server    0.12.3* [upstream changes]
  - recompile datakit-client-9p 0.12.3* [upstream changes]
  - recompile datakit-server-9p 0.12.3* [upstream changes]
===== 4 to recompile =====
[datakit-client.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] no changes from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-client-9p.0.12.3
-> removed   datakit-client.0.12.3
-> installed datakit-client.0.12.3
-> removed   datakit-server-9p.0.12.3
-> removed   datakit-server.0.12.3
-> installed datakit-server.0.12.3
-> installed datakit-client-9p.0.12.3
-> installed datakit-server-9p.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 8c4ab19e69c0
Removing intermediate container cf780142680f
Step 15/23 : RUN opam install datakit -ytv
 ---> Running in 7d3cd9f8891c

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [datakit.0.12.3: rsync]
[datakit.0.12.3] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit 0.12.3*
[datakit.0.12.3] synchronised from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.3)
Processing  1/2: [datakit: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.3)
-         test alias tests/datakit/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit.
- This run has ID `59A9DC5A-D1B4-44DB-925A-039679DFB351`.
- [33m ...[m                [36mserver[m           0   Writes.[32m[OK][m                [36mserver[m           0   Writes.
- [33m ...[m                [36mserver[m           1   RW.[32m[OK][m                [36mserver[m           1   RW.
- [33m ...[m                [36mserver[m           2   Blobs fast.[32m[OK][m                [36mserver[m           2   Blobs fast.
- [33m ...[m                [36mserver[m           3   Blobs random.[32m[OK][m                [36mserver[m           3   Blobs random.
- [33m ...[m                [36mserver[m           4   Streams.[32m[OK][m                [36mserver[m           4   Streams.
- [33m ...[m                [36mconduit[m          0   basic.[32m[OK][m                [36mconduit[m          0   basic.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.3/_build/default/tests/datakit/_build/_tests/59A9DC5A-D1B4-44DB-925A-039679DFB351`.
- [32mTest Successful[m in 0.004s. 6 tests run.
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit-9p" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.3)
-         test alias tests/datakit-9p/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit-9p.
- This run has ID `77ABC86C-511F-461C-A7C0-447BC9D1BCEB`.
- [33m ...[m                [36mserver[m          0   Transaction.[32m[OK][m                [36mserver[m          0   Transaction.
- [33m ...[m                [36mserver[m          1   Qids.[32m[OK][m                [36mserver[m          1   Qids.
- [33m ...[m                [36mserver[m          2   Watch.[32m[OK][m                [36mserver[m          2   Watch.
- [33m ...[m                [36mserver[m          3   Range.[32m[OK][m                [36mserver[m          3   Range.
- [33m ...[m                [36mserver[m          4   Rename branch.[32m[OK][m                [36mserver[m          4   Rename branch.
- [33m ...[m                [36mserver[m          5   Rename file.[32m[OK][m                [36mserver[m          5   Rename file.
- [33m ...[m                [36mserver[m          6   Truncate.[32m[OK][m                [36mserver[m          6   Truncate.
- [33m ...[m                [36mserver[m          7   Parents.[32m[OK][m                [36mserver[m          7   Parents.
- [33m ...[m                [36mserver[m          8   Merge.[32m[OK][m                [36mserver[m          8   Merge.
- [33m ...[m                [36mserver[m          9   Merge_metadata.[32m[OK][m                [36mserver[m          9   Merge_metadata.
- [33m ...[m                [36mserver[m         10   Merge empty.[32m[OK][m                [36mserver[m         10   Merge empty.
- [33m ...[m                [36mserver[m         11   Conflicts.[32m[OK][m                [36mserver[m         11   Conflicts.
- [33m ...[m                [36mserver[m         12   Stable inodes.[32m[OK][m                [36mserver[m         12   Stable inodes.
- [33m ...[m                [36mserver[m         13   Remotes.[33m[SKIP][m              [36mserver[m         13   Remotes.
- [33m ...[m                [36mserver[m         14   Debug.[32m[OK][m                [36mserver[m         14   Debug.
- [33m ...[m                [36mclient[m          0   Transaction.[32m[OK][m                [36mclient[m          0   Transaction.
- [33m ...[m                [36mclient[m          1   Watch.[32m[OK][m                [36mclient[m          1   Watch.
- [33m ...[m                [36mclient[m          2   Make dirs.[32m[OK][m                [36mclient[m          2   Make dirs.
- [33m ...[m                [36mclient[m          3   Truncate.[32m[OK][m                [36mclient[m          3   Truncate.
- [33m ...[m                [36mclient[m          4   Parents.[32m[OK][m                [36mclient[m          4   Parents.
- [33m ...[m                [36mclient[m          5   Merge.[32m[OK][m                [36mclient[m          5   Merge.
- [33m ...[m                [36mclient[m          6   Diff.[32m[OK][m                [36mclient[m          6   Diff.
- [33m ...[m                [36mclient[m          7   Merge_metadata.[32m[OK][m                [36mclient[m          7   Merge_metadata.
- [33m ...[m                [36mclient[m          8   Merge empty.[32m[OK][m                [36mclient[m          8   Merge empty.
- [33m ...[m                [36mclient[m          9   Conflicts.[32m[OK][m                [36mclient[m          9   Conflicts.
- [33m ...[m                [36mclient[m         10   Large write.[32m[OK][m                [36mclient[m         10   Large write.
- [33m ...[m                [36mclient[m         11   Remove.[32m[OK][m                [36mclient[m         11   Remove.
- [33m ...[m                [36mclient[m         12   Remotes.[33m[SKIP][m              [36mclient[m         12   Remotes.
- [33m ...[m                [36mclient[m         13   Create_or_replace.[33m[SKIP][m              [36mclient[m         13   Create_or_replace.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.3/_build/default/tests/datakit-9p/_build/_tests/77ABC86C-511F-461C-A7C0-447BC9D1BCEB`.
- [32mTest Successful[m in 0.244s. 26 tests run.
-> compiled  datakit.0.12.3
-> installed datakit.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> b17f75c931a8
Removing intermediate container 7d3cd9f8891c
Step 16/23 : RUN sudo cp $(opam config exec -- which datakit) /usr/bin/datakit &&     sudo cp $(opam config exec -- which datakit-mount) /usr/bin/datakit-mount
 ---> Running in 7ab99f6f53b1
 ---> 795eb0e77e7e
Removing intermediate container 7ab99f6f53b1
Step 17/23 : FROM alpine:3.9
3.9: Pulling from library/alpine
Digest: sha256:7746df395af22f04212cd25a92c1d6dbc5a06a0ca9579a229ef43008d4d1302a
Status: Image is up to date for alpine:3.9
 ---> 055936d39205
Step 18/23 : RUN apk add --no-cache libev gmp tzdata ca-certificates git openssh-client bash
 ---> Using cache
 ---> f0347bab59d3
Step 19/23 : EXPOSE 5640
 ---> Using cache
 ---> 95748f9f313d
Step 20/23 : ENTRYPOINT /usr/bin/datakit
 ---> Using cache
 ---> f6a8bd77edb2
Step 21/23 : CMD --url=tcp://0.0.0.0:5640 --git=/data -v
 ---> Using cache
 ---> 95e45f4f441e
Step 22/23 : COPY --from=0 /usr/bin/datakit /usr/bin/datakit
 ---> 3701b2d7586c
Removing intermediate container 03bbb85d78a6
Step 23/23 : COPY --from=0 /usr/bin/datakit-mount /usr/bin/datakit-mount
 ---> 0fe31ac30ec6
Removing intermediate container 3e003e37f492
Successfully built 0fe31ac30ec6
[2019-07-12 14:57.48] Success
