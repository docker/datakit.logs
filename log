=== Docker build Dockerfile.ci
[2019-07-12 14:52.21] Starting...
Cloning into '/tmp/with_clone114bd91e'...
done.
HEAD is now at 2fc17d8 Merge pull request #647 from avsm/uri-sexp
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.396 MB
Step 1/17 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:80f944d8924204d38d8c588a6906010ddfd6364c226a26077b99a95028270790
Status: Image is up to date for ocaml/opam2:alpine
 ---> bfd59b6fbeb7
Step 2/17 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 3cfa4c307c86
Step 3/17 : RUN opam switch 4.07
 ---> Using cache
 ---> 61f8129282a1
Step 4/17 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 45575532b93e
Step 5/17 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset 340acb7d88264bf29485b1d292388e1d91dc2214 --hard &&     opam update -u
 ---> Using cache
 ---> bf4c8aa48c34
Step 6/17 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> 18bba6bd5a39
Step 7/17 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> fadc6c1094dc
Step 8/17 : RUN opam exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> db33a3222fb3
Step 9/17 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> d17f556f6780
Step 10/17 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> 437a0bf12aeb
Step 11/17 : RUN sudo apk add --no-cache libressl-dev linux-headers pcre-dev
 ---> Using cache
 ---> 23e2c6db25ba
Step 12/17 : RUN opam install datakit-ci --deps -t
 ---> Using cache
 ---> 6482a1457c4a
Step 13/17 : COPY . /home/opam/src/datakit
 ---> bba45dc09433
Removing intermediate container a4986505682b
Step 14/17 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 64fc7c2e08e3
 ---> 4936d45c16c1
Removing intermediate container 64fc7c2e08e3
Step 15/17 : RUN opam update --dev && opam upgrade
 ---> Running in 9bb3ad7c963a

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.4] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client     0.12.3* [upstream changes]
  - recompile datakit-server     0.12.3* [upstream changes]
  - recompile datakit-client-git 0.12.3* [upstream changes]
  - recompile datakit-client-9p  0.12.3* [upstream changes]
  - recompile datakit-server-9p  0.12.3* [upstream changes]
  - recompile datakit-github     0.12.3* [upstream changes]
  - recompile datakit            0.12.3* [upstream changes]
===== 7 to recompile =====
[datakit.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-github.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] no changes from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-github.0.12.3
-> removed   datakit-client-9p.0.12.3
-> removed   datakit-client-git.0.12.3
-> removed   datakit-client.0.12.3
-> installed datakit-client.0.12.3
-> removed   datakit.0.12.3
-> removed   datakit-server-9p.0.12.3
-> removed   datakit-server.0.12.3
-> installed datakit-server.0.12.3
-> installed datakit-client-9p.0.12.3
-> installed datakit-client-git.0.12.3
-> installed datakit-server-9p.0.12.3
-> installed datakit-github.0.12.3
-> installed datakit.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 28eec8d3d208
Removing intermediate container 9bb3ad7c963a
Step 16/17 : RUN opam install datakit-ci -ytv
 ---> Running in bffd32db49a2

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [datakit-ci.0.12.4: rsync]
[datakit-ci.0.12.4] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-ci 0.12.4*
[datakit-ci.0.12.4] synchronised from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit-ci: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-ci" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-ci.0.12.4)
- ocaml-crunch ci/src/cI_static.ml
- Generating cI_static.ml
- Skipping generation of .mli
Processing  1/2: [datakit-ci: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "ci/tests" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-ci.0.12.4)
-      test_ci alias ci/tests/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit-ci.
- This run has ID `891D544D-2626-4CEE-8021-E29DD43A3399`.
- [33m ...[m                [36mci[m          0   Simple.[32m[OK][m                [36mci[m          0   Simple.
- [33m ...[m                [36mci[m          1   Branch.[32m[OK][m                [36mci[m          1   Branch.
- [33m ...[m                [36mci[m          2   Circle rebuild.[32m[OK][m                [36mci[m          2   Circle rebuild.
- [33m ...[m                [36mci[m          3   Logs.[32m[OK][m                [36mci[m          3   Logs.
- [33m ...[m                [36mci[m          4   Cancel.[32m[OK][m                [36mci[m          4   Cancel.
- [33m ...[m                [36mci[m          5   Cache (disk).[32m[OK][m                [36mci[m          5   Cache (disk).
- [33m ...[m                [36mci[m          6   Cache (memory).[32m[OK][m                [36mci[m          6   Cache (memory).
- [33m ...[m                [36mci[m          7   Test pending.[32m[OK][m                [36mci[m          7   Test pending.
- [33m ...[m                [36mci[m          8   Git.[32m[OK][m                [36mci[m          8   Git.
- [33m ...[m                [36mci[m          9   Git (clone).[32m[OK][m                [36mci[m          9   Git (clone).
- [33m ...[m                [36mci[m         10   Git tag.[32m[OK][m                [36mci[m         10   Git tag.
- [33m ...[m                [36mci[m         11   Cross-project.[32m[OK][m                [36mci[m         11   Cross-project.
- [33m ...[m                [36mci[m         12   Auth.[32m[OK][m                [36mci[m         12   Auth.
- [33m ...[m                [36mci[m         13   Roles.[32m[OK][m                [36mci[m         13   Roles.
- [33m ...[m                [36mci[m         14   Live logs.[32m[OK][m                [36mci[m         14   Live logs.
- [33m ...[m                [36mci[m         15   History.[32m[OK][m                [36mci[m         15   History.
- [33m ...[m                [36mci[m         16   Process.[32m[OK][m                [36mci[m         16   Process.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit-ci.0.12.4/_build/default/ci/tests/_build/_tests/891D544D-2626-4CEE-8021-E29DD43A3399`.
- [32mTest Successful[m in 0.316s. 17 tests run.
-> compiled  datakit-ci.0.12.4
-> installed datakit-ci.0.12.4
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 553672533442
Removing intermediate container bffd32db49a2
Step 17/17 : VOLUME /secrets
 ---> Running in 293d96e000f7
 ---> a01858a423da
Removing intermediate container 293d96e000f7
Successfully built a01858a423da
[2019-07-12 14:53.15] Success
