=== Docker build Dockerfile.client
[2019-04-14 19:15.44] Starting...
Cloning into '/tmp/with_clone13166d9'...
done.
HEAD is now at 9ddd615 autoformat all code using ocamlformat 0.9
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.346 MB
Step 1/16 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:ff181c65a9850ab2a4da983b4496ab30e68f68e076474a7605b4ba2522aeb24a
Status: Image is up to date for ocaml/opam2:alpine
 ---> 29728b366e85
Step 2/16 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 1e9ade81d76e
Step 3/16 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 53ee9b5bde41
Step 4/16 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset df84483e523f1eec710a2118e05920f9cdf882d3 --hard &&     opam update -u
 ---> Using cache
 ---> 1cb3193c3e82
Step 5/16 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> e025d81acf57
Step 6/16 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> fe1c590114b6
Step 7/16 : RUN opam config exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> d1d4d807e979
Step 8/16 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> e31b74deba3a
Step 9/16 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> dd533b3ad2d0
Step 10/16 : RUN OPAMSOLVERTIMEOUT=120 opam install datakit-client-git datakit-client-9p --deps -t
 ---> Using cache
 ---> 9f1c1f7de9f4
Step 11/16 : COPY . /home/opam/src/datakit
 ---> f26b0357e417
Removing intermediate container eb948ea0531f
Step 12/16 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 1167dfd5b962
 ---> f11835816831
Error removing intermediate container 1167dfd5b962: driver "aufs" failed to remove root filesystem for 1167dfd5b9620e6be38a16a3b0aa8507630d24939733fb1cb92def283a140e3a: could not remove diff path for id c9e539fb2efd248a7517669799dcf667e5a004db312aa41091ddcb6f8e0cb84b: error preparing atomic delete: rename /var/lib/docker/aufs/diff/c9e539fb2efd248a7517669799dcf667e5a004db312aa41091ddcb6f8e0cb84b /var/lib/docker/aufs/diff/c9e539fb2efd248a7517669799dcf667e5a004db312aa41091ddcb6f8e0cb84b-removing: device or resource busy
Step 13/16 : RUN opam update --dev && opam upgrade
 ---> Running in 01c553f5ab74

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client 0.12.3* [upstream changes]
[datakit-client.0.12.3] no changes from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-client.0.12.3
-> installed datakit-client.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 1c67bfcb5bbc
Removing intermediate container 1167dfd5b962
Removing intermediate container 01c553f5ab74
Step 14/16 : RUN opam install datakit-client-9p datakit-client-git -tyv
 ---> Running in 49dfa24436e6

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit-client-9p.0.12.3: rsync]
Processing  2/2: [datakit-client-9p.0.12.3: rsync] [datakit-client-git.0.12.3: rsync]
[datakit-client-9p.0.12.3] no changes from file:///home/opam/src/datakit
Processing  2/2: [datakit-client-git.0.12.3: rsync]
[datakit-client-git.0.12.3] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-client-git 0.12.3*
  - install datakit-client-9p  0.12.3*
===== 2 to install =====
Processing  1/2: [datakit-client-9p.0.12.3: rsync]
Processing  2/2: [datakit-client-9p.0.12.3: rsync] [datakit-client-git.0.12.3: rsync]
[datakit-client-9p.0.12.3] synchronised from file:///home/opam/src/datakit
Processing  2/2: [datakit-client-git.0.12.3: rsync]
[datakit-client-git.0.12.3] synchronised from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/4: [datakit-client-9p: dune build]
Processing  2/4: [datakit-client-9p: dune build] [datakit-client-git: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-client-9p" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-client-9p.0.12.3)
-> compiled  datakit-client-9p.0.12.3
Processing  2/4: [datakit-client-git: dune build]
-> installed datakit-client-9p.0.12.3
Processing  3/4: [datakit-client-git: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-client-git" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-client-git.0.12.3)
Processing  3/4: [datakit-client-git: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit-git" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-client-git.0.12.3)
-         test alias tests/datakit-git/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- +7142us irw-polling [INFO] Polling mode
- Testing datakit-git.
- This run has ID `36430F01-8D37-4AB0-BF9D-62D30859086A`.
- [33m ...[m                [36mclient[m          0   Transaction.[32m[OK][m                [36mclient[m          0   Transaction.
- [33m ...[m                [36mclient[m          1   Watch.[32m[OK][m                [36mclient[m          1   Watch.
- [33m ...[m                [36mclient[m          2   Make dirs.[32m[OK][m                [36mclient[m          2   Make dirs.
- [33m ...[m                [36mclient[m          3   Truncate.[32m[OK][m                [36mclient[m          3   Truncate.
- [33m ...[m                [36mclient[m          4   Parents.[32m[OK][m                [36mclient[m          4   Parents.
- [33m ...[m                [36mclient[m          5   Merge.[32m[OK][m                [36mclient[m          5   Merge.
- [33m ...[m                [36mclient[m          6   Diff.[32m[OK][m                [36mclient[m          6   Diff.
- [33m ...[m                [36mclient[m          7   Merge_metadata.[32m[OK][m                [36mclient[m          7   Merge_metadata.
- [33m ...[m                [36mclient[m          8   Merge empty.[32m[OK][m                [36mclient[m          8   Merge empty.
- [33m ...[m                [36mclient[m          9   Conflicts.[32m[OK][m                [36mclient[m          9   Conflicts.
- [33m ...[m                [36mclient[m         10   Large write.[32m[OK][m                [36mclient[m         10   Large write.
- [33m ...[m                [36mclient[m         11   Remove.[32m[OK][m                [36mclient[m         11   Remove.
- [33m ...[m                [36mclient[m         12   Remotes.[33m[SKIP][m              [36mclient[m         12   Remotes.
- [33m ...[m                [36mclient[m         13   Create_or_replace.[33m[SKIP][m              [36mclient[m         13   Create_or_replace.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit-client-git.0.12.3/_build/default/tests/datakit-git/_build/_tests/36430F01-8D37-4AB0-BF9D-62D30859086A`.
- [32mTest Successful[m in 0.448s. 12 tests run.
-> compiled  datakit-client-git.0.12.3
-> installed datakit-client-git.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> e551c097e9f7
Removing intermediate container 49dfa24436e6
Step 15/16 : RUN sudo mkdir /data && sudo chown opam.nogroup /data && chmod 700 /data &&     sudo cp $(opam config exec -- which datakit-mount) /usr/bin/datakit-mount
 ---> Running in c12d5eb5e9b8
 ---> 2f42f06a9f29
Removing intermediate container c12d5eb5e9b8
Step 16/16 : CMD bash -c "/usr/bin/datakit-mount -h $(getent hosts datakit | awk '{print $1}')";     bash
 ---> Running in 1e7d85f64c08
 ---> e5178f7e8993
Error removing intermediate container 1e7d85f64c08: driver "aufs" failed to remove root filesystem for 1e7d85f64c0840247e99672a177ec544e0ba27a82f2ace3964e8df5f9e537101: could not remove diff path for id 0427ffe2742f923e6d04da09a2691c6e5afa1c67d8b9f08f9ea540d73ce99e10: error preparing atomic delete: rename /var/lib/docker/aufs/diff/0427ffe2742f923e6d04da09a2691c6e5afa1c67d8b9f08f9ea540d73ce99e10 /var/lib/docker/aufs/diff/0427ffe2742f923e6d04da09a2691c6e5afa1c67d8b9f08f9ea540d73ce99e10-removing: device or resource busy
Successfully built e5178f7e8993
[2019-04-14 19:16.10] Success
