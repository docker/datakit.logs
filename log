=== Docker build Dockerfile.github
[2019-04-13 20:21.05] Starting...
Cloning into '/tmp/with_cloned737901'...
done.
HEAD is now at f9d909b circleci: use the system switch for ocaml
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 5.963 MB
Step 1/22 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:ff181c65a9850ab2a4da983b4496ab30e68f68e076474a7605b4ba2522aeb24a
Status: Image is up to date for ocaml/opam2:alpine
 ---> 29728b366e85
Step 2/22 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 9845c9095217
Step 3/22 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> a314e26d5d73
Step 4/22 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset df84483e523f1eec710a2118e05920f9cdf882d3 --hard &&     opam update -u
 ---> Using cache
 ---> 7708b3fefe7e
Step 5/22 : RUN opam install alcotest lwt conf-libev inotify tls
 ---> Using cache
 ---> 7df10bdee48f
Step 6/22 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> f1ca51bfd476
Step 7/22 : RUN opam exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> d16829b98b80
Step 8/22 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> 9a73e71179ef
Step 9/22 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> fda976fbc253
Step 10/22 : RUN opam install datakit-bridge-github --deps -t
 ---> Using cache
 ---> 96838a5fa7c5
Step 11/22 : COPY . /home/opam/src/datakit
 ---> 53262c34460a
Removing intermediate container e9206e47207c
Step 12/22 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in 428b8f59067b
 ---> 2de2519323cb
Removing intermediate container 428b8f59067b
Step 13/22 : RUN opam update --dev && opam upgrade
 ---> Running in dd72e306cb17

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client     0.12.3* [upstream changes]
  - recompile datakit-server     0.12.3* [upstream changes]
  - recompile datakit-client-git 0.12.3* [upstream changes]
  - recompile datakit-client-9p  0.12.3* [upstream changes]
  - recompile datakit-server-9p  0.12.3* [upstream changes]
  - recompile datakit-github     0.12.3* [upstream changes]
  - recompile datakit            0.12.3* [upstream changes]
===== 7 to recompile =====
[datakit.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-github.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] no changes from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-github.0.12.3
-> removed   datakit-client-9p.0.12.3
-> removed   datakit-client-git.0.12.3
-> removed   datakit-client.0.12.3
-> installed datakit-client.0.12.3
-> removed   datakit.0.12.3
-> removed   datakit-server-9p.0.12.3
-> removed   datakit-server.0.12.3
-> installed datakit-server.0.12.3
-> installed datakit-client-9p.0.12.3
-> installed datakit-client-git.0.12.3
-> installed datakit-server-9p.0.12.3
-> installed datakit-github.0.12.3
-> installed datakit.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> fd5b728a8f7b
Removing intermediate container dd72e306cb17
Step 14/22 : RUN opam install datakit-bridge-github -ytv
 ---> Running in 86d98307a93a

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [datakit-bridge-github.0.12.3: rsync]
[datakit-bridge-github.0.12.3] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-bridge-github 0.12.3*
[datakit-bridge-github.0.12.3] synchronised from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit-bridge-github: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-bridge-github" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-bridge-github.0.12.3)
Processing  1/2: [datakit-bridge-github: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit-bridge-github" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-bridge-github.0.12.3)
-         test alias tests/datakit-bridge-github/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit-github.
- This run has ID `57F8271B-84C5-4266-B02F-EC86A2C5EEEF`.
- [33m ...[m                [36mgithub-9p[m          0   Transaction.[32m[OK][m                [36mgithub-9p[m          0   Transaction.
- [33m ...[m                [36mgithub-9p[m          1   Watch.[32m[OK][m                [36mgithub-9p[m          1   Watch.
- [33m ...[m                [36mgithub-9p[m          2   Make dirs.[32m[OK][m                [36mgithub-9p[m          2   Make dirs.
- [33m ...[m                [36mgithub-9p[m          3   Truncate.[32m[OK][m                [36mgithub-9p[m          3   Truncate.
- [33m ...[m                [36mgithub-9p[m          4   Parents.[32m[OK][m                [36mgithub-9p[m          4   Parents.
- [33m ...[m                [36mgithub-9p[m          5   Merge.[32m[OK][m                [36mgithub-9p[m          5   Merge.
- [33m ...[m                [36mgithub-9p[m          6   Diff.[32m[OK][m                [36mgithub-9p[m          6   Diff.
- [33m ...[m                [36mgithub-9p[m          7   Merge_metadata.[32m[OK][m                [36mgithub-9p[m          7   Merge_metadata.
- [33m ...[m                [36mgithub-9p[m          8   Merge empty.[32m[OK][m                [36mgithub-9p[m          8   Merge empty.
- [33m ...[m                [36mgithub-9p[m          9   Conflicts.[32m[OK][m                [36mgithub-9p[m          9   Conflicts.
- [33m ...[m                [36mgithub-9p[m         10   Large write.[32m[OK][m                [36mgithub-9p[m         10   Large write.
- [33m ...[m                [36mgithub-9p[m         11   Remove.[32m[OK][m                [36mgithub-9p[m         11   Remove.
- [33m ...[m                [36mgithub-9p[m         12   Remotes.[33m[SKIP][m              [36mgithub-9p[m         12   Remotes.
- [33m ...[m                [36mgithub-9p[m         13   Create_or_replace.[33m[SKIP][m              [36mgithub-9p[m         13   Create_or_replace.
- [33m ...[m                [36mgithub[m             0   basic-snapshot.[32m[OK][m                [36mgithub[m             0   basic-snapshot.
- [33m ...[m                [36mgithub[m             1   snapshot.[32m[OK][m                [36mgithub[m             1   snapshot.
- [33m ...[m                [36mgithub[m             2   capabilities.[32m[OK][m                [36mgithub[m             2   capabilities.
- [33m ...[m                [36mgithub[m             3   cleanup.[32m[OK][m                [36mgithub[m             3   cleanup.
- [33m ...[m                [36mgithub[m             4   events.[32m[OK][m                [36mgithub[m             4   events.
- [33m ...[m                [36mgithub[m             5   updates.[32m[OK][m                [36mgithub[m             5   updates.
- [33m ...[m                [36mgithub[m             6   startup.[32m[OK][m                [36mgithub[m             6   startup.
- [33m ...[m                [36mgithub[m             7   random-github.[32m[OK][m                [36mgithub[m             7   random-github.
- [33m ...[m                [36mgithub[m             8   random-github-*.[33m[SKIP][m              [36mgithub[m             8   random-github-*.
- [33m ...[m                [36mgithub[m             9   random-datakit.[32m[OK][m                [36mgithub[m             9   random-datakit.
- [33m ...[m                [36mgithub[m            10   random-datakit-*.[33m[SKIP][m              [36mgithub[m            10   random-datakit-*.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit-bridge-github.0.12.3/_build/default/tests/datakit-bridge-github/_build/_tests/57F8271B-84C5-4266-B02F-EC86A2C5EEEF`.
- [32mTest Successful[m in 4.044s. 21 tests run.
-> compiled  datakit-bridge-github.0.12.3
-> installed datakit-bridge-github.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 12f8d9c02fb5
Removing intermediate container 86d98307a93a
Step 15/22 : RUN sudo cp $(opam config exec -- which datakit-bridge-github) /usr/bin/
 ---> Running in d529f96df312
 ---> dfb1d87aea63
Removing intermediate container d529f96df312
Step 16/22 : FROM alpine:3.9
3.9: Pulling from library/alpine
Digest: sha256:28ef97b8686a0b5399129e9b763d5b7e5ff03576aa5580d6f4182a49c5fe1913
Status: Image is up to date for alpine:3.9
 ---> cdf98d1859c1
Step 17/22 : RUN apk add --no-cache libev gmp tzdata ca-certificates
 ---> Using cache
 ---> c8a5c768be0d
Step 18/22 : EXPOSE 5640
 ---> Using cache
 ---> 01e43b0914cd
Step 19/22 : EXPOSE 5641
 ---> Using cache
 ---> fde204348fe6
Step 20/22 : ENTRYPOINT /usr/bin/datakit-bridge-github
 ---> Using cache
 ---> fdc97c1ef913
Step 21/22 : CMD --listen=tcp://0.0.0.0:5641 -v --datakit=tcp:127.0.0.1:5640
 ---> Using cache
 ---> e0cac15d3c1a
Step 22/22 : COPY --from=0 /usr/bin/datakit-bridge-github /usr/bin/datakit-bridge-github
 ---> Using cache
 ---> 3a4035207e20
Successfully built 3a4035207e20
[2019-04-13 20:21.51] Success
