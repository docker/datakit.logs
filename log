=== Docker build Dockerfile
[2019-03-11 12:13.04] Starting...
Cloning into '/tmp/with_clone30e72aa0'...
done.
HEAD is now at 0c95850 release 0.12.3
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 5.871 MB
Step 1/22 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:22c602c753b42f7db92ad08187b89c80ae9a68991f65b2d6743fb862d20b0875
Status: Image is up to date for ocaml/opam2:alpine
 ---> b29794a38c38
Step 2/22 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 09ba0013948b
Step 3/22 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 478e83d1f5e6
Step 4/22 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset b01a2e4e1ac2fb545d593ad40bc95b4a78dec9e2 --hard &&     opam update -u
 ---> Using cache
 ---> 9e5b4761e5bf
Step 5/22 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> 8df47c40e2de
Step 6/22 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> 0c36844080a6
Step 7/22 : RUN opam exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> 4313b97de2f9
Step 8/22 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> c4d37ada7f85
Step 9/22 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> f1d205e6c987
Step 10/22 : RUN opam install datakit --deps -t
 ---> Using cache
 ---> 08cb9c039a6a
Step 11/22 : COPY . /home/opam/src/datakit
 ---> 6bad4ed6a2b3
Removing intermediate container ef394fd1e60d
Step 12/22 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in f13802441019
 ---> c37281e91e00
Removing intermediate container f13802441019
Step 13/22 : RUN opam update --dev && opam upgrade
 ---> Running in ef71b1443e51

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.2] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.2] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client    0.12.2* [upstream changes]
  - recompile datakit-server    0.12.2* [upstream changes]
  - recompile datakit-client-9p 0.12.2* [upstream changes]
  - recompile datakit-server-9p 0.12.2* [upstream changes]
===== 4 to recompile =====

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-client-9p.0.12.2
-> removed   datakit-client.0.12.2
-> installed datakit-client.0.12.2
-> removed   datakit-server-9p.0.12.2
-> removed   datakit-server.0.12.2
-> installed datakit-server.0.12.2
-> installed datakit-client-9p.0.12.2
-> installed datakit-server-9p.0.12.2
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 024e6fbc8bc1
Removing intermediate container ef71b1443e51
Step 14/22 : RUN opam install datakit -ytv
 ---> Running in a9cac6be3b7c

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [datakit.0.12.2: rsync]
[datakit.0.12.2] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit 0.12.2*

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.2)
Processing  1/2: [datakit: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.2)
-         test alias tests/datakit/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit.
- This run has ID `20AD4E12-49F1-400D-9578-5D4FB692129E`.
- [33m ...[m                [36mserver[m           0   Writes.[32m[OK][m                [36mserver[m           0   Writes.
- [33m ...[m                [36mserver[m           1   RW.[32m[OK][m                [36mserver[m           1   RW.
- [33m ...[m                [36mserver[m           2   Blobs fast.[32m[OK][m                [36mserver[m           2   Blobs fast.
- [33m ...[m                [36mserver[m           3   Blobs random.[32m[OK][m                [36mserver[m           3   Blobs random.
- [33m ...[m                [36mserver[m           4   Streams.[32m[OK][m                [36mserver[m           4   Streams.
- [33m ...[m                [36mconduit[m          0   basic.[32m[OK][m                [36mconduit[m          0   basic.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.2/_build/default/tests/datakit/_build/_tests/20AD4E12-49F1-400D-9578-5D4FB692129E`.
- [32mTest Successful[m in 0.004s. 6 tests run.
+ /home/opam/.opam/4.07/bin/dune "runtest" "tests/datakit-9p" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.2)
-         test alias tests/datakit-9p/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit-9p.
- This run has ID `2919BB31-F70E-4E59-A552-3A624F83378B`.
- [33m ...[m                [36mserver[m          0   Transaction.[32m[OK][m                [36mserver[m          0   Transaction.
- [33m ...[m                [36mserver[m          1   Qids.[32m[OK][m                [36mserver[m          1   Qids.
- [33m ...[m                [36mserver[m          2   Watch.[32m[OK][m                [36mserver[m          2   Watch.
- [33m ...[m                [36mserver[m          3   Range.[32m[OK][m                [36mserver[m          3   Range.
- [33m ...[m                [36mserver[m          4   Rename branch.[32m[OK][m                [36mserver[m          4   Rename branch.
- [33m ...[m                [36mserver[m          5   Rename file.[32m[OK][m                [36mserver[m          5   Rename file.
- [33m ...[m                [36mserver[m          6   Truncate.[32m[OK][m                [36mserver[m          6   Truncate.
- [33m ...[m                [36mserver[m          7   Parents.[32m[OK][m                [36mserver[m          7   Parents.
- [33m ...[m                [36mserver[m          8   Merge.[32m[OK][m                [36mserver[m          8   Merge.
- [33m ...[m                [36mserver[m          9   Merge_metadata.[32m[OK][m                [36mserver[m          9   Merge_metadata.
- [33m ...[m                [36mserver[m         10   Merge empty.[32m[OK][m                [36mserver[m         10   Merge empty.
- [33m ...[m                [36mserver[m         11   Conflicts.[32m[OK][m                [36mserver[m         11   Conflicts.
- [33m ...[m                [36mserver[m         12   Stable inodes.[32m[OK][m                [36mserver[m         12   Stable inodes.
- [33m ...[m                [36mserver[m         13   Remotes.[33m[SKIP][m              [36mserver[m         13   Remotes.
- [33m ...[m                [36mserver[m         14   Debug.[32m[OK][m                [36mserver[m         14   Debug.
- [33m ...[m                [36mclient[m          0   Transaction.[32m[OK][m                [36mclient[m          0   Transaction.
- [33m ...[m                [36mclient[m          1   Watch.[32m[OK][m                [36mclient[m          1   Watch.
- [33m ...[m                [36mclient[m          2   Make dirs.[32m[OK][m                [36mclient[m          2   Make dirs.
- [33m ...[m                [36mclient[m          3   Truncate.[32m[OK][m                [36mclient[m          3   Truncate.
- [33m ...[m                [36mclient[m          4   Parents.[32m[OK][m                [36mclient[m          4   Parents.
- [33m ...[m                [36mclient[m          5   Merge.[32m[OK][m                [36mclient[m          5   Merge.
- [33m ...[m                [36mclient[m          6   Diff.[32m[OK][m                [36mclient[m          6   Diff.
- [33m ...[m                [36mclient[m          7   Merge_metadata.[32m[OK][m                [36mclient[m          7   Merge_metadata.
- [33m ...[m                [36mclient[m          8   Merge empty.[32m[OK][m                [36mclient[m          8   Merge empty.
- [33m ...[m                [36mclient[m          9   Conflicts.[32m[OK][m                [36mclient[m          9   Conflicts.
- [33m ...[m                [36mclient[m         10   Large write.[32m[OK][m                [36mclient[m         10   Large write.
- [33m ...[m                [36mclient[m         11   Remove.[32m[OK][m                [36mclient[m         11   Remove.
- [33m ...[m                [36mclient[m         12   Remotes.[33m[SKIP][m              [36mclient[m         12   Remotes.
- [33m ...[m                [36mclient[m         13   Create_or_replace.[33m[SKIP][m              [36mclient[m         13   Create_or_replace.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit.0.12.2/_build/default/tests/datakit-9p/_build/_tests/2919BB31-F70E-4E59-A552-3A624F83378B`.
- [32mTest Successful[m in 0.276s. 26 tests run.
-> compiled  datakit.0.12.2
-> installed datakit.0.12.2
Done.
# Run eval $(opam env) to update the current shell environment
 ---> c6af090d33aa
Removing intermediate container a9cac6be3b7c
Step 15/22 : RUN sudo cp $(opam config exec -- which datakit) /usr/bin/datakit &&     sudo cp $(opam config exec -- which datakit-mount) /usr/bin/datakit-mount
 ---> Running in 8af02a994e6a
 ---> 7efb86026b1a
Removing intermediate container 8af02a994e6a
Step 16/22 : FROM alpine:3.9
3.9: Pulling from library/alpine
Digest: sha256:644fcb1a676b5165371437feaa922943aaf7afcfa8bfee4472f6860aad1ef2a0
Status: Image is up to date for alpine:3.9
 ---> 5cb3aa00f899
Step 17/22 : RUN apk add --no-cache libev gmp tzdata ca-certificates git openssh-client bash
 ---> Using cache
 ---> 82a331d4d831
Step 18/22 : EXPOSE 5640
 ---> Using cache
 ---> b2e917ecfa23
Step 19/22 : ENTRYPOINT /usr/bin/datakit
 ---> Using cache
 ---> 6576f4b90470
Step 20/22 : CMD --url=tcp://0.0.0.0:5640 --git=/data -v
 ---> Using cache
 ---> 83ae4bceaaff
Step 21/22 : COPY --from=0 /usr/bin/datakit /usr/bin/datakit
 ---> Using cache
 ---> bd6b2955e216
Step 22/22 : COPY --from=0 /usr/bin/datakit-mount /usr/bin/datakit-mount
 ---> Using cache
 ---> 1d40616580af
Successfully built 1d40616580af
[2019-03-11 12:13.41] Success
