=== Docker build Dockerfile.ci
[2019-04-14 19:15.44] Starting...
Cloning into '/tmp/with_clone351bb9f9'...
done.
HEAD is now at 9ddd615 autoformat all code using ocamlformat 0.9
Sending build context to Docker daemon 557.1 kBSending build context to Docker daemon 1.114 MBSending build context to Docker daemon 1.671 MBSending build context to Docker daemon 2.228 MBSending build context to Docker daemon 2.785 MBSending build context to Docker daemon 3.342 MBSending build context to Docker daemon 3.899 MBSending build context to Docker daemon 4.456 MBSending build context to Docker daemon 5.014 MBSending build context to Docker daemon 5.571 MBSending build context to Docker daemon 6.128 MBSending build context to Docker daemon 6.346 MB
Step 1/16 : FROM ocaml/opam2:alpine
alpine: Pulling from ocaml/opam2
Digest: sha256:ff181c65a9850ab2a4da983b4496ab30e68f68e076474a7605b4ba2522aeb24a
Status: Image is up to date for ocaml/opam2:alpine
 ---> 29728b366e85
Step 2/16 : RUN sudo apk add --no-cache tzdata aspcud gmp-dev perl libev-dev m4
 ---> Using cache
 ---> 1e9ade81d76e
Step 3/16 : ENV OPAMERRLOGLEN 0 OPAMYES 1
 ---> Using cache
 ---> 53ee9b5bde41
Step 4/16 : RUN git -C /home/opam/opam-repository fetch origin &&     git -C /home/opam/opam-repository reset df84483e523f1eec710a2118e05920f9cdf882d3 --hard &&     opam update -u
 ---> Using cache
 ---> 1cb3193c3e82
Step 5/16 : RUN opam install alcotest lwt conf-libev inotify
 ---> Using cache
 ---> e025d81acf57
Step 6/16 : COPY check-libev.ml /tmp/check-libev.ml
 ---> Using cache
 ---> fe1c590114b6
Step 7/16 : RUN opam exec -- ocaml /tmp/check-libev.ml
 ---> Using cache
 ---> a78e8cf8d253
Step 8/16 : COPY *.opam /home/opam/src/datakit/
 ---> Using cache
 ---> 8815f0a5f7e6
Step 9/16 : RUN opam pin add /home/opam/src/datakit/ -n
 ---> Using cache
 ---> dd3a34dc582b
Step 10/16 : RUN sudo apk add --no-cache libressl-dev linux-headers pcre-dev
 ---> Using cache
 ---> c5031d5ae189
Step 11/16 : RUN opam install datakit-ci --deps -t
 ---> Using cache
 ---> 4d6778a81c23
Step 12/16 : COPY . /home/opam/src/datakit
 ---> dd72446c2f1e
Removing intermediate container f2bddb14905a
Step 13/16 : RUN sudo chown opam.nogroup -R /home/opam/src/datakit
 ---> Running in a6792a839e82
 ---> 9557838839b6
Removing intermediate container a6792a839e82
Step 14/16 : RUN opam update --dev && opam upgrade
 ---> Running in 7775e9df0841

<><> Synchronising development packages <><><><><><><><><><><><><><><><><><><><>
[datakit.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-bridge-local-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-ci.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-github.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server.0.12.3] synchronised from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] synchronised from file:///home/opam/src/datakit
Now run 'opam upgrade' to apply any package updates.
The following actions will be performed:
  - recompile datakit-client     0.12.3* [upstream changes]
  - recompile datakit-server     0.12.3* [upstream changes]
  - recompile datakit-client-git 0.12.3* [upstream changes]
  - recompile datakit-client-9p  0.12.3* [upstream changes]
  - recompile datakit-server-9p  0.12.3* [upstream changes]
  - recompile datakit-github     0.12.3* [upstream changes]
  - recompile datakit            0.12.3* [upstream changes]
===== 7 to recompile =====
[datakit.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-9p.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-client-git.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-github.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server.0.12.3] no changes from file:///home/opam/src/datakit
[datakit-server-9p.0.12.3] no changes from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
-> removed   datakit-github.0.12.3
-> removed   datakit-client-9p.0.12.3
-> removed   datakit-client-git.0.12.3
-> removed   datakit-client.0.12.3
-> installed datakit-client.0.12.3
-> removed   datakit.0.12.3
-> removed   datakit-server-9p.0.12.3
-> removed   datakit-server.0.12.3
-> installed datakit-server.0.12.3
-> installed datakit-client-9p.0.12.3
-> installed datakit-client-git.0.12.3
-> installed datakit-server-9p.0.12.3
-> installed datakit-github.0.12.3
-> installed datakit.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> 8cc75d34b734
Removing intermediate container 7775e9df0841
Step 15/16 : RUN opam install datakit-ci -ytv
 ---> Running in d141b97d3226

<><> Synchronising pinned packages ><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/1: [datakit-ci.0.12.3: rsync]
[datakit-ci.0.12.3] no changes from file:///home/opam/src/datakit

The following actions will be performed:
  - install datakit-ci 0.12.3*
[datakit-ci.0.12.3] synchronised from file:///home/opam/src/datakit

<><> Processing actions <><><><><><><><><><><><><><><><><><><><><><><><><><><><>
Processing  1/2: [datakit-ci: dune build]
+ /home/opam/.opam/4.07/bin/dune "build" "-p" "datakit-ci" "-j" "71" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-ci.0.12.3)
- ocaml-crunch ci/src/cI_static.ml
- Generating cI_static.ml
- Skipping generation of .mli
Processing  1/2: [datakit-ci: dune runtest]
+ /home/opam/.opam/4.07/bin/dune "runtest" "ci/tests" (CWD=/home/opam/.opam/4.07/.opam-switch/build/datakit-ci.0.12.3)
-      test_ci alias ci/tests/runtest
- /bin/sh: tput: not found
- stty: 'standard input': Not a tty
- Testing datakit-ci.
- This run has ID `6C41BF8A-D266-44CD-8CD1-409CAEFFB124`.
- [33m ...[m                [36mci[m          0   Simple.[32m[OK][m                [36mci[m          0   Simple.
- [33m ...[m                [36mci[m          1   Branch.[32m[OK][m                [36mci[m          1   Branch.
- [33m ...[m                [36mci[m          2   Circle rebuild.[32m[OK][m                [36mci[m          2   Circle rebuild.
- [33m ...[m                [36mci[m          3   Logs.[32m[OK][m                [36mci[m          3   Logs.
- [33m ...[m                [36mci[m          4   Cancel.[32m[OK][m                [36mci[m          4   Cancel.
- [33m ...[m                [36mci[m          5   Cache (disk).[32m[OK][m                [36mci[m          5   Cache (disk).
- [33m ...[m                [36mci[m          6   Cache (memory).[32m[OK][m                [36mci[m          6   Cache (memory).
- [33m ...[m                [36mci[m          7   Test pending.[32m[OK][m                [36mci[m          7   Test pending.
- [33m ...[m                [36mci[m          8   Git.[32m[OK][m                [36mci[m          8   Git.
- [33m ...[m                [36mci[m          9   Git (clone).[32m[OK][m                [36mci[m          9   Git (clone).
- [33m ...[m                [36mci[m         10   Git tag.[32m[OK][m                [36mci[m         10   Git tag.
- [33m ...[m                [36mci[m         11   Cross-project.[32m[OK][m                [36mci[m         11   Cross-project.
- [33m ...[m                [36mci[m         12   Auth.[32m[OK][m                [36mci[m         12   Auth.
- [33m ...[m                [36mci[m         13   Roles.[32m[OK][m                [36mci[m         13   Roles.
- [33m ...[m                [36mci[m         14   Live logs.[32m[OK][m                [36mci[m         14   Live logs.
- [33m ...[m                [36mci[m         15   History.[32m[OK][m                [36mci[m         15   History.
- [33m ...[m                [36mci[m         16   Process.[32m[OK][m                [36mci[m         16   Process.
- The full test results are available in `/home/opam/.opam/4.07/.opam-switch/build/datakit-ci.0.12.3/_build/default/ci/tests/_build/_tests/6C41BF8A-D266-44CD-8CD1-409CAEFFB124`.
- [32mTest Successful[m in 0.460s. 17 tests run.
-> compiled  datakit-ci.0.12.3
-> installed datakit-ci.0.12.3
Done.
# Run eval $(opam env) to update the current shell environment
 ---> b445cb7f0538
Removing intermediate container d141b97d3226
Step 16/16 : VOLUME /secrets
 ---> Running in 45780f516405
 ---> bab2e47f48ad
Removing intermediate container 45780f516405
Successfully built bab2e47f48ad
[2019-04-14 19:16.50] Success
